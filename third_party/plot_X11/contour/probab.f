      SUBROUTINE PROBAB(Z,NPXRD,NX,NPYRD,Z1,Z2,Z3,SIGMA,RMAX,
     & COEFF)
      DIMENSION Z(NPXRD,NPYRD)
      DIMENSION BUFF(1000)
      DIMENSION TABLE(400)
      DIMENSION COEFF(1)
C   ARRAY TABLE GIVES AREAS UNDER THE STANDARD NORMAL DISTRIBUTION
C   CURVE BETWEEN ZERO AND T.GE.0 IN STEPS OF 0.01
      DATA (TABLE(I),I=1,100)/
     & .0000,.0040,.0080,.0120,.0160,.0199,.0239,.0279,.0319,.0359,
     & .0398,.0438,.0478,.0517,.0557,.0596,.0636,.0675,.0714,.0754,
     & .0793,.0832,.0871,.0910,.0948,.0987,.1026,.1064,.1103,.1141,
     & .1179,.1217,.1255,.1293,.1331,.1368,.1406,.1443,.1480,.1517,
     & .1554,.1591,.1628,.1664,.1700,.1736,.1772,.1808,.1844,.1879,
     & .1915,.1950,.1985,.2019,.2054,.2088,.2123,.2157,.2190,.2224,
     & .2258,.2291,.2324,.2357,.2389,.2422,.2454,.2486,.2518,.2549,
     & .2580,.2612,.2642,.2673,.2704,.2734,.2764,.2794,.2823,.2852,
     & .2881,.2910,.2939,.2967,.2996,.3023,.3051,.3078,.3106,.3133,
     & .3159,.3186,.3212,.3238,.3264,.3289,.3315,.3340,.3365,.3389/
      DATA (TABLE(I),I=101,200)/
     & .3413,.3438,.3461,.3485,.3508,.3531,.3554,.3577,.3599,.3621,
     & .3643,.3665,.3686,.3708,.3729,.3749,.3770,.3790,.3810,.3830,
     & .3849,.3869,.3888,.3907,.3925,.3944,.3962,.3980,.3997,.4015,
     & .4032,.4049,.4066,.4082,.4099,.4115,.4131,.4147,.4162,.4177,
     & .4192,.4207,.4222,.4236,.4251,.4265,.4279,.4292,.4306,.4319,
     & .4332,.4345,.4357,.4370,.4382,.4394,.4406,.4418,.4429,.4441,
     & .4452,.4463,.4474,.4484,.4495,.4505,.4515,.4525,.4535,.4545,
     & .4554,.4564,.4573,.4582,.4591,.4599,.4608,.4616,.4625,.4633,
     & .4641,.4649,.4656,.4664,.4671,.4678,.4686,.4693,.4699,.4706,
     & .4713,.4719,.4726,.4732,.4738,.4744,.4750,.4756,.4761,.4767/
      DATA (TABLE(I),I=201,300)/
     & .4772,.4778,.4783,.4788,.4793,.4798,.4803,.4808,.4812,.4817,
     & .4821,.4826,.4830,.4834,.4838,.4842,.4846,.4850,.4854,.4857,
     & .4861,.4864,.4868,.4871,.4875,.4878,.4881,.4884,.4887,.4890,
     & .4893,.4896,.4898,.4901,.4904,.4906,.4909,.4911,.4913,.4916,
     & .4918,.4920,.4922,.4925,.4927,.4929,.4931,.4932,.4934,.4936,
     & .4938,.4940,.4941,.4943,.4945,.4946,.4948,.4949,.4951,.4952,
     & .4953,.4955,.4956,.4957,.4959,.4960,.4961,.4962,.4963,.4964,
     & .4965,.4966,.4967,.4968,.4969,.4970,.4971,.4972,.4973,.4974,
     & .4974,.4975,.4976,.4976,.4977,.4978,.4979,.4979,.4980,.4981,
     & .4981,.4982,.4982,.4983,.4984,.4984,.4985,.4985,.4986,.4986/
      DATA (TABLE(I),I=301,400)/
     & .4987,.4987,.4987,.4988,.4988,.4989,.4989,.4989,.4990,.4990,
     & .4990,.4991,.4991,.4991,.4992,.4992,.4992,.4992,.4993,.4993,
     & .4993,.4993,.4994,.4994,.4994,.4994,.4994,.4995,.4995,.4995,
     & .4995,.4995,.4995,.4996,.4996,.4996,.4996,.4996,.4996,.4997,
     & .4997,.4997,.4997,.4997,.4997,.4997,.4997,.4997,.4997,.4998,
     & .4998,.4998,.4998,.4998,.4998,.4998,.4998,.4998,.4998,.4998,
     & .4998,.4998,.4999,.4999,.4999,.4999,.4999,.4999,.4999,.4999,
     & .4999,.4999,.4999,.4999,.4999,.4999,.4999,.4999,.4999,.4999,
     & .4999,.4999,.4999,.4999,.4999,.4999,.4999,.4999,.4999,.4999,
     & .5000,.5000,.5000,.5000,.5000,.5000,.5000,.5000,.5000,.5000/
C
  200 FORMAT(1X,'  ***    WARNING FROM SUB PROBAB ***',/,
     & ' THE INPUT VALUE FOR SIGMA IS ',E9.3,/,
     & ' THE COMPUTATION IS CONTINUED BY SETTING SIGMA = 1.0E-10 ')
C
      IF(SIGMA.LE.0.0)   THEN
      WRITE(6,200) SIGMA
      SIGMA=1.0E-10
      END IF
C
      DO 1200   I=1,NPXRD
      DO 1200   J=1,NPYRD
      Z(I,J)=Z(I,J)/SIGMA
 1200 CONTINUE
C       
      ZMIN=Z1/SIGMA
      ZREF=ZMIN
      DO 5000   I=1,NPYRD
      DO 2000   J=1,NPXRD
C
      T= ZREF - Z(J,I)
      AT100=ABS(T) * 100.0
      L= MIN(399.0,AT100) + 1
      AREA= 0.5000 + TABLE(L)*SIGN(1.0,T)
C
      Z(J,I)= MAX(1.0E-36,AREA)
 2000 CONTINUE
C
 5000 CONTINUE
      RETURN
      END


