      SUBROUTINE OUT(TLOSS,NPX,NPY,SD,FREQ,
     & RMIN,RMAX,RSTEP,
     & XMIN,XMAX,XLEN,XINC,
     & YMIN,YMAX,YLEN,YINC,
     & ZMIN,ZMAX,ZINC,
     & TITLE,
     & LUCDR,LUBDR)

      REAL  NRNG

      CHARACTER*3 BWCOL, PACKGE
      CHARACTER*3 XBTYPE, YBTYPE
      CHARACTER*4 TITLE(20), TITLEX, TITLEY
      CHARACTER*5 MODEL
      CHARACTER*12 OPTION
      CHARACTER*20 FILENM
      CHARACTER*80 TIX, TIY

      REAL TLOSS(NPX,NPY)
      REAL SECTOR(28)

      COMMON/XAXC/TITLEX(20),XBTYPE
      COMMON/YAXC/TITLEY(20),YBTYPE
      EQUIVALENCE (TIX,TITLEX), (TIY,TITLEY)

      DATA FLAGRC, DUMMY/0.0, 0.0/
      DATA CAY, NRNG/ 5.0, 5.0/
      DATA X1PL,Y1PL/1.5,1.5/,HGTPT,HGTC,LABPT,NDIV,
     *NARC/0.1,0.14,-3,1,5/,LABC,LWGT/-1,0/,NSM/0/
      DATA BWCOL, PACKGE/'   ','   '/
      DATA SIGMA/8.0/
  120 FORMAT(5E15.4)
  150 FORMAT('CONDR,',A3,'   ')
  401 FORMAT(1H ,F15.4,3X,'  NUMBER OF DATA POINTS ALONG THE X AXIS')
  402 FORMAT(1H ,F15.4,3X,'  NUMBER OF DATA POINTS ALONG THE Y AXIS')
  403 FORMAT(1H ,F15.4,3X,'  DIVX  ' )
  404 FORMAT(1H ,F15.4,3X,'  DIVY  ' )
  405 FORMAT(1H ,F15.4,3X,'  FLAGRC =0 ROWS, =1 COLUMNS')
  406 FORMAT(1H ,F15.4,3X,'  MIN DEPTH (m) ' )
  407 FORMAT(1H ,F15.4,3X,'  MAX DEPTH (m) ' )
  408 FORMAT(1H ,F15.4,3X,'  SOURCE DEPTH (m) ' )
  409 FORMAT(1H ,F15.4,3X,'  NUMBER OF GRID POINTS ALONG THE X AXIS ' )
  410 FORMAT(1H ,F15.4,3X,'  NUMBER OF GRID POINTS ALONG THE Y AXIS ' )
  411 FORMAT(1H ,F15.4,3X,'  FREQUENCY (Hz)' )
  412 FORMAT(1H ,F15.4,3X,'  DUMMY ' )
  413 FORMAT(1H ,F15.4,3X,'  CAY   ' )
  414 FORMAT(1H ,F15.4,3X,'  NRNG  ' )
  415 FORMAT(1H ,F15.4,3X,'  ZMIN ' )
  416 FORMAT(1H ,F15.4,3X,'  ZMAX ' )
  417 FORMAT(1H ,F15.4,3X,'  ZINC ' )
  418 FORMAT(1H ,F15.4,3X,'  X ORIGIN OF PLOT IN INCHES ' )
  419 FORMAT(1H ,F15.4,3X,'  SIGMA ' )
  420 FORMAT(1H ,F15.4,3X,'  Y ORIGIN OF PLOT IN INCHES ' )
  421 FORMAT(1H ,F15.4,3X,'  NSM   ' )
  422 FORMAT(1H ,F15.4,3X,'  HGTPT ' )
  423 FORMAT(1H ,F15.4,3X,'  HGTC ' )
  424 FORMAT(1H ,F15.4,3X,'  LABPT ' )
  425 FORMAT(1H ,F15.4,3X,'  NDIV ' )
  426 FORMAT(1H ,F15.4,3X,'  NARC ' )
  427 FORMAT(1H ,F15.4,3X,'  LABC ' )
  428 FORMAT(1H ,F15.4,3X,'  LWGT ' )
  550 FORMAT('DR',A1,I2.2,'F',I2.2,'.CON        ')
  650 FORMAT('DR',A1,I2.2,'F',I2.2,'D.CON       ')
  655 FORMAT('$ @CONTUR  DR',A1,I2.2,'F',I2.2)
  660 FORMAT('COPYOUT  DR',A1,I2.2,'F',I2.2,'.CON ')
  670 FORMAT('COPYOUT  DR',A1,I2.2,'F',I2.2,'D.CON ')
  800 FORMAT(A12)
  810 FORMAT(A20)
  820 FORMAT('RANGE (m)   ',17('    '))
  840 FORMAT('DEPTH (m)   ',17('    '))
  850 FORMAT(20A4)
  900 FORMAT(1X,F15.4,3X,'  XLEFT',/,F16.4,4X,' XRIGHT',/,F16.4,3X,
     *'  XSCALE',/,F16.4,4X,' XINC')
  901 FORMAT(1X,F15.4,3X,'  YUP',/,F16.4,3X,'  YDOWN',/,F16.4,3X,
     *'  YSCALE',/,F16.4,3X,'  YINC')
  950 FORMAT(1H ,F15.4,1X,'    RMIN',/,F16.4,2X,'   RMAX')
C
C  DEFINITION OF CONSTANTS.
C
      TWOPI=2.0*ACOS(-1.0)
      DIVX=1.0
      DIVY=1.0
      XBTYPE='LIN'
      YBTYPE='LIN'
      WRITE(TIX,820)
      WRITE(TIY,840)
C

      DO 1000   I=2,28
 1000 SECTOR(I)=0.0

C   NUMBER OF DATA POINTS ALONG THE X AXIS
      SECTOR(1)=NPX   
      SECTOR(2)=NPY
      SECTOR(7)=YMAX
C   NUMBER OF GRID POINTS ALONG THE X AXIS
      SECTOR(9)=NPX  
C   NUMBER OF GRID POINTS ALONG THE Y AXIS
      SECTOR(10)=NPY
C   FREQUENCY
      SECTOR(11)=FREQ          
C    ZMIN
      SECTOR(15)=ZMIN
C   ZMAX
      SECTOR(16)=ZMAX
C   ZINC
      SECTOR(17)=ZINC

C   SEE DATA STATEMENT
      SECTOR(18)=X1PL   
      SECTOR(20)=Y1PL   
      SECTOR(21)=NSM
      SECTOR(22)=HGTPT
      SECTOR(23)=HGTC
      SECTOR(24)=LABPT
      SECTOR(25)=NDIV
      SECTOR(26)=NARC
      SECTOR(27)=LABC
      SECTOR(28)=LWGT
C
      WRITE(OPTION,150) 'COH'
      WRITE(LUCDR,800)OPTION
      WRITE(LUCDR,850)TITLE
C
      WRITE(FILENM,650) ' ANYTHING WILL DO '
C
      WRITE(LUCDR,810)FILENM
      WRITE(LUCDR,850)TITLEX
C   RMIN,RMAX
      WRITE(LUCDR,950) RMIN,RMAX
C   XLEFT,XRIGHT,XSCALE,XINC
      XSCALE=(XMAX-XMIN)/XLEN
      WRITE(LUCDR,900) RMIN,RMAX,XSCALE,XINC
      WRITE(LUCDR,850)TITLEY
C   YUP,YDOWN,YSCALE,YINC
      YSCALE=(YMAX-YMIN)/YLEN
      WRITE(LUCDR,901) YMIN,YMAX,YSCALE,YINC
C   NUMBER OF DATA POINTS ALONG THE X AXIS
      WRITE(LUCDR,401) SECTOR(1)   
C   NUMBER OF DATA POINTS ALONG THE Y AXIS
      WRITE(LUCDR,402) SECTOR(2)   
C   DUMMY
      WRITE(LUCDR,403) DIVX              
      WRITE(LUCDR,404) DIVY              
      WRITE(LUCDR,405) FLAGRC              
      WRITE(LUCDR,406) YMIN
C   WATER DEPTH (M)
      WRITE(LUCDR,407) SECTOR(7)     
C   SOURCE DEPTH
      SECTOR(8)= SD
      WRITE(LUCDR,408) SECTOR(8)
C   NUMBER OF GRID POINTS ALONG THE X AXIS
      WRITE(LUCDR,409) SECTOR(9)
C   NUMBER OF GRID POINTS ALONG THE Y AXIS
      WRITE(LUCDR,410) SECTOR(10)
C   FREQUENCY
      WRITE(LUCDR,411) SECTOR(11)    
C   DUMMY
      WRITE(LUCDR,412) DUMMY              
C CAY
      WRITE(LUCDR,413) CAY              
C NRNG
      WRITE(LUCDR,414) NRNG              
C ZMIN
      WRITE(LUCDR,415)SECTOR(15)    
C   ZMAX
      WRITE(LUCDR,416)SECTOR(16)    
C   ZINC
      WRITE(LUCDR,417)SECTOR(17)    
C   X1PL : X ORIGIN OF PLOT IN INCHES
      WRITE(LUCDR,418)SECTOR(18)    
C   SIGMA FOR EVENTUAL STATISTIC ON FIGURE OF MERIT
      WRITE(LUCDR,419) SIGMA              
C   Y1PL : Y ORIGIN OF PLOT IN INCHES
      WRITE(LUCDR,420)SECTOR(20)    
C   NSM
      WRITE(LUCDR,421)SECTOR(21)    
C   HGTPT
      WRITE(LUCDR,422)SECTOR(22)    
C   HGTC
      WRITE(LUCDR,423)SECTOR(23)    
C   LABPT
      WRITE(LUCDR,424)SECTOR(24)    
C   NDIV
      WRITE(LUCDR,425)SECTOR(25)    
C   NARC
      WRITE(LUCDR,426)SECTOR(26)    
C   LABC
      WRITE(LUCDR,427)SECTOR(27)    
C   LWGT
      WRITE(LUCDR,428)SECTOR(28)    
 1500 CLOSE(UNIT=LUCDR)
 1600 CONTINUE


C
C
C   SECTOR(4) IS A FLAG MAINTAINED FOR COMPATIBILITY WITH
C   OTHER PROGRAMS
      SECTOR(4)=1.0
      SECTOR(5)=PLANE
      SECTOR(6)=RSTEP
      SECTOR(7)=RMIN
      SECTOR(8)=RMAX

      WRITE(LUBDR,120)(SECTOR(I),I=1,28)

      DO 3000   IY=1,NPY
      WRITE(LUBDR,120)(TLOSS(IX,IY),IX=1,NPX)
 3000 CONTINUE
      CLOSE(UNIT=LUBDR)

      END
